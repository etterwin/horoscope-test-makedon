if(window.jQuery){var MobicoSDK={service:null,project:null,land:null,uuid:null,token:null,pub:null,esub:null,extra:{},params:{},test:0,visited:null,sessid:null,url:"https://api-cf.mobi.club",extend:function(o){MobicoSDK.extra=$.extend(MobicoSDK.extra,o||{})},check:function(o){(o=o||{}).success=o.success||MobicoSDK.checkOk,MobicoSDK.uuid=o.uuid||MobicoSDK.uuid,MobicoSDK.uuid&&$.post(MobicoSDK.url+"/sub/check",{uuid:MobicoSDK.uuid},function(s){s.success&&s.result.redirect?"function"==typeof o.success?o.success(s.result):location.href=s.result.redirect:setTimeout(function(){MobicoSDK.check(o)},o.interval||3e3)},"json")},create:function(o){o=o||{},$.post(MobicoSDK.url+"/sub/create",{project:o.project||MobicoSDK.project,land:o.land||MobicoSDK.land||null,msisdn:MobicoSDK.tools.msisdn(o.msisdn||""),mno:o.mno||"",extra:$.extend(MobicoSDK.extra,o.extra||{}),esub:MobicoSDK.esub||"",pub:MobicoSDK.pub||"",test:MobicoSDK.test,flow:o.flow||(o.stub?"mo":""),platform:MobicoSDK.tools.platform(),visited:MobicoSDK.visited,sessid:MobicoSDK.sessid,ip:"auto"},function(s){s.success?(MobicoSDK.uuid=s.result.uuid,instructions=s.result.instructions,$(".mbc-shortcode").text(instructions.shortcode),$(".mbc-message").text(instructions.message||instructions.keyword),$(".mbc-keyword").text(instructions.keyword),$(".mbc-click2sms").attr("href","sms:"+instructions.shortcode+"?body="+encodeURIComponent(instructions.message||instructions.keyword)),"function"==typeof o.success&&o.success(s.result.uuid,s.result)):s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},pin:function(o){o=o||{},$.post(MobicoSDK.url+"/sub/pin",{uuid:o.uuid||MobicoSDK.uuid,pin:o.pin,test:MobicoSDK.test},function(s){s.success&&"function"==typeof o.success&&o.success(s.result),s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},sendPin:function(o){o=o||{},$.post(MobicoSDK.url+"/sub/sendPin",{uuid:o.uuid||MobicoSDK.uuid,test:MobicoSDK.test},function(s){s.success&&"function"==typeof o.success&&o.success(s.result),s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},footer:function(o){o=o||{},$.post(MobicoSDK.url+"/tools/texts",{id:o.project||MobicoSDK.project,field:"footer_project"},function(s){s.success?$((o.container||"#terms")+", .mbc-footer").html(s.result):s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},init:function(){var o={};location.search.substr(1).split("&").forEach(function(s){var e=s.split("=");o[e[0]]=decodeURIComponent(e[1])}),MobicoSDK.visited=sessionStorage.visited||null,MobicoSDK.params=o,MobicoSDK.uuid=MobicoSDK.params.uuid||"",MobicoSDK.esub=MobicoSDK.params.esub||sessionStorage.esub||"",MobicoSDK.pub=MobicoSDK.params.pub||MobicoSDK.params.pub_id||sessionStorage.pub||"",MobicoSDK.sessid=sessionStorage.sessid||MobicoSDK.tools.uuid(),MobicoSDK.test=parseInt(MobicoSDK.params.test||0)||0,sessionStorage.esub=MobicoSDK.esub,sessionStorage.pub=MobicoSDK.pub,sessionStorage.sessid=MobicoSDK.sessid,MobicoSDK.session.load(),MobicoSDK.stats(1)},wap:function(o){o=o||{},location.href=MobicoSDK.url+"/sub/wap?"+$.param({project:o.project||MobicoSDK.project,land:o.land||MobicoSDK.land||null,success_url:o.success_url||null,fail_url:o.fail_url||null,msisdn:MobicoSDK.tools.msisdn(o.msisdn||""),mno:o.mno||"",esub:MobicoSDK.esub||null,pub:MobicoSDK.pub||null,test:MobicoSDK.test,extra:$.extend(MobicoSDK.extra,o.extra||{}),platform:MobicoSDK.tools.platform(),visited:MobicoSDK.visited,sessid:MobicoSDK.sessid,redirect:1})},identify:function(o){o=o||{},location.href=MobicoSDK.url+"/sub/identify?"+$.param({project:o.project||MobicoSDK.project,success_url:o.success_url||null,fail_url:o.fail_url||null,test:MobicoSDK.test,msisdn:MobicoSDK.tools.msisdn(o.msisdn||MobicoSDK.params.msisdn||""),mno:o.mno||MobicoSDK.params.mno||"",sessid:MobicoSDK.sessid,redirect:1})},auth:function(o){o=o||{},$.post(MobicoSDK.url+"/v2/auth",{msisdn:MobicoSDK.tools.msisdn(o.msisdn||""),password:o.password||"",project:o.project||MobicoSDK.project||null,service:o.service||MobicoSDK.service||null,extra:$.extend(MobicoSDK.extra,o.extra||{})},function(s){s.success?"function"==typeof o.success?o.success(s.result):s.result.redirect&&(location.href=s.result.redirect):s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},checkOk:function(o){setTimeout(function(){location.href=o.redirect},3e3),location.href="#ok"},pre:function(o){o=o||{},$.post(MobicoSDK.url+"/sub/pre",{project:o.project||MobicoSDK.project||"",land:o.land||MobicoSDK.land||null,mno:o.mno||"",extra:$.extend(MobicoSDK.extra,o.extra||{}),esub:o.esub||MobicoSDK.esub,pub:o.pub||MobicoSDK.pub,test:MobicoSDK.test,platform:MobicoSDK.tools.platform(),visited:MobicoSDK.visited,sessid:MobicoSDK.sessid},function(s){if(s.success){var e=s.result.instructions;MobicoSDK.uuid=s.result.uuid,MobicoSDK.token=s.result.token,$(".mobico-token, .mbc-token").text(MobicoSDK.token),$(".mbc-shortcode").text(e.shortcode),$(".mbc-message").text(e.message),$(".mbc-keyword").text(e.keyword),$(".mbc-click2sms").attr("href","sms:"+e.shortcode+"?body="+encodeURIComponent(e.message)),"function"==typeof o.success&&o.success(s.result)}else s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},pmt:function(o){o=o||{},$.post(MobicoSDK.url+"/pmt/send",{uuid:o.uuid||MobicoSDK.uuid,test:MobicoSDK.test},function(s){s.success?"function"==typeof o.success&&o.success(s.result):s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},info:function(o){o=o||{},$.post(MobicoSDK.url+"/sub/info",{uuid:o.uuid||MobicoSDK.uuid},function(s){s.success?"function"==typeof o.success&&o.success(s):s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},track:function(o){o=o||{},$.post(MobicoSDK.url+"/v4/tools/track",{},function(s){s.error?("function"==typeof o.error&&o.error(s.error.message,s.error.code),console.error("MobicoSDK Error:",s.message,s.code)):"function"==typeof o.success&&o.success(s.result)},"json")},tag:function(o){"string"==typeof o&&(o={tag:o}),o=o||{};var s=MobicoSDK.tools.platform();$.post(MobicoSDK.url+"/tools/tag",{tag:o.tag,land:o.land||MobicoSDK.land,adcombo:MobicoSDK.esub?1:0,pub:MobicoSDK.pub||"",test:MobicoSDK.test,platform:s,sessid:MobicoSDK.sessid},function(e){e.success?("function"==typeof o.success&&o.success(),console.info("MobicoSDK:",s,o.tag)):e.error&&("function"==typeof o.error&&o.error(e.message,e.code),console.error("MobicoSDK Error:",e.message,e.code))},"json")},lookup:function(o){o=o||{},$.post(MobicoSDK.url+"/sub/lookup",{msisdn:MobicoSDK.tools.msisdn(o.msisdn),project:MobicoSDK.project},function(s){s.success?"function"==typeof o.success&&o.success(s.result):s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},storage:{set:function(o){o=o||{},$.post(MobicoSDK.url+"/storage/set",{uuid:o.uuid||null,data:o.data||{},ttl:o.ttl||3600},function(s){s.success?"function"==typeof o.success&&o.success(s.result.uuid):s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},get:function(o){o=o||{},$.post(MobicoSDK.url+"/storage/get",{uuid:o.uuid},function(s){s.success?"function"==typeof o.success&&o.success(s.result):s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")},delete:function(o){o=o||{},$.post(MobicoSDK.url+"/storage/delete",{uuid:o.uuid},function(s){s.success?"function"==typeof o.success&&o.success(s.result):s.error&&("function"==typeof o.error&&o.error(s.message,s.code),console.error("MobicoSDK Error:",s.message,s.code))},"json")}},tools:{uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){var s=16*Math.random()|0;return("x"===o?s:3&s|8).toString(16)})},platform:function(){return navigator.userAgent.match(/android|iphone|ipad|ipod|opera mini|webos|iemobile|blackberry|mobile|phone/i)||Math.min($(document).width(),$(document).height())<=640?"mobile":"desktop"},msisdn:function(o){return o=o.toString().replace(/[^0-9]/g,"")}},session:{data:{},get:function(o){return MobicoSDK.session.data[o]||null},set:function(o,s){MobicoSDK.session.data[o]=s,MobicoSDK.session.save()},load:function(){MobicoSDK.session.data=JSON.parse(localStorage.session||"{}")},save:function(){localStorage.session=JSON.stringify(MobicoSDK.session.data)}},stats:function(){MobicoSDK.test||(MobicoSDK.land||MobicoSDK.project?$.post(MobicoSDK.url+"/tools/stats",{land:MobicoSDK.land,project:MobicoSDK.project,adcombo:MobicoSDK.esub?1:0,pub:MobicoSDK.pub||"",sessid:MobicoSDK.sessid,platform:MobicoSDK.tools.platform(),url:location.href,ref:document.referrer},function(o){o.success&&!MobicoSDK.visited&&(MobicoSDK.visited=o.result.date,sessionStorage.visited=o.result.date),o.error&&console.error("MobicoSDK Error:",o.message,o.code)},"json"):setTimeout(MobicoSDK.stats,100))}};MobicoSDK.init(),mbc=MobicoSDK}else console.error("MobicoSDK: jQuery required");
